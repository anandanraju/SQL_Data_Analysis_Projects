DROP DATABASE IF EXISTS PIZZA_DATA_ANALYSIS;

USE PIZZA_DATA_ANALYSIS

CREATE DATABASE IF NOT EXISTS PIZZA_DATA_ANALYSIS;

SELECT * FROM ORDER_DETAILS;
SELECT * FROM ORDERS;
SELECT * FROM PIZZA_TYPES;
SELECT * FROM PIZZAS;

-- Retrieve the total number of orders placed ?
SELECT COUNT(DISTINCT ORDER_ID) FROM ORDERS;

-- CALCULATE TOTAL REVENUE GENERATED BY PIZZA SALES ?
SELECT OD.PIZZA_ID, OD.QUANTITY, P.PRICE FROM ORDER_DETAILS AS OD 
JOIN PIZZAS AS P ON P.PIZZA_ID = OD.PIZZA_ID;

SELECT CAST(SUM(OD.QUANTITY*P.PRICE) AS DECIMAL(10,2)) AS TOTAL_REVENUE FROM ORDER_DETAILS AS OD
JOIN PIZZAS AS P ON P.PIZZA_ID = OD.PIZZA_ID;

-- IDENTIFYING THE HIGHEST PRICE PIZZA ?
SELECT PT.NAME AS "PIZZA NAME", CAST(P.PRICE AS DECIMAL(10,2)) AS "PRICE"
FROM PIZZAS AS P JOIN PIZZA_TYPES AS PT ON PT.PIZZA_TYPE_ID = P.PIZZA_TYPE_ID
ORDER BY PRICE DESC LIMIT 1;








